// ğŸ§ ==== éŸ³ä¹æ’­æ”¾å™¨é€»è¾‘ ==== //

const music = new Audio('audio/éŸ³ä¹.mp3'); // åŠ è½½èƒŒæ™¯éŸ³ä¹
let isPlaying = false;
let volumeLevel = 3; // åˆå§‹éŸ³é‡ç­‰çº§ 1â€“5

// è·å–æ§åˆ¶å…ƒç´ 
const toggleBtn = document.getElementById('music-toggle');
const volumeBars = document.querySelectorAll('.volume-bars .bar');
const currentTimeDisplay = document.getElementById('current-time');
const totalTimeDisplay = document.getElementById('total-time');
const progressBar = document.getElementById('progress-bar');

// â¯ï¸ æ’­æ”¾ / æš‚åœ æ§åˆ¶
toggleBtn.addEventListener('click', () => {
  if (!isPlaying) {
    music.play();
    toggleBtn.textContent = 'â¸';
  } else {
    music.pause();
    toggleBtn.textContent = 'â–¶';
  }
  isPlaying = !isPlaying;
});

// ğŸ”Š æ›´æ–°éŸ³é‡æ¡æ ·å¼ä¸æ’­æ”¾å™¨éŸ³é‡å€¼
function updateVolume(level) {
  volumeBars.forEach(bar => bar.classList.toggle('active', +bar.dataset.level <= level));
  music.volume = level / 5;
}
updateVolume(volumeLevel);

// â•â– éŸ³é‡æ§åˆ¶æ¥å£
window.increaseVolume = () => { if (volumeLevel < 5) updateVolume(++volumeLevel); };
window.decreaseVolume = () => { if (volumeLevel > 0) updateVolume(--volumeLevel); };

// ğŸ”¢ éŸ³ä¹å…ƒæ•°æ®åŠ è½½å®Œæˆï¼Œåˆå§‹åŒ–æ€»æ—¶é•¿ä¸è¿›åº¦æ¡æœ€å¤§å€¼
music.addEventListener('loadedmetadata', () => {
  progressBar.max = Math.floor(music.duration);
  totalTimeDisplay.textContent = formatTime(music.duration);
});

// â±ï¸ æ’­æ”¾è¿›åº¦æ›´æ–°æ—¶é—´ï¼Œæ›´æ–°è¿›åº¦æ¡ä¸æ˜¾ç¤ºæ•°å­—
music.addEventListener('timeupdate', () => {
  const cur = Math.floor(music.currentTime);
  progressBar.value = cur;
  currentTimeDisplay.textContent = formatTime(cur);
  const percent = (cur / music.duration) * 100;
  progressBar.style.background = `linear-gradient(to right, #f9c038 ${percent}%, #ccc ${percent}%)`;
});

// ğŸšï¸ æ‹–åŠ¨è¿›åº¦æ¡è·³è½¬æ’­æ”¾æ—¶é—´
progressBar.addEventListener('input', () => { music.currentTime = +progressBar.value; });

// æ ¼å¼åŒ–æ—¶é—´ä¸º mm:ss
function formatTime(sec) {
  return `${String(Math.floor(sec / 60)).padStart(2, '0')}:${String(Math.floor(sec % 60)).padStart(2, '0')}`;
}

// ğŸ¬ ==== ä½œå“é›†æ»šåŠ¨é€»è¾‘ ==== //

const wrapper = document.getElementById('portfolio-scroll');
const items = wrapper.querySelectorAll('.portfolio-item');
let currentIndex = 0; // åˆå§‹ä¸ºç¬¬ä¸€ä¸ªä½œå“

// æ›´æ–°æ¯ä¸ªä½œå“çš„æ ·å¼çŠ¶æ€ï¼ˆactive/prev/next/hiddenï¼‰
function updateCarousel() {
  items.forEach((item, i) => {
    item.classList.remove('active', 'prev', 'next');
    if (i === currentIndex) {
      item.classList.add('active');
    } else if (i === (currentIndex + items.length - 1) % items.length) {
      item.classList.add('prev');
    } else if (i === (currentIndex + 1) % items.length) {
      item.classList.add('next');
    }
  });
}

// ğŸ“Œ æ»šåŠ¨å‡½æ•°ï¼Œé€šè¿‡å‚æ•° direction æ§åˆ¶å·¦ï¼ˆ-1ï¼‰å³ï¼ˆ1ï¼‰åˆ‡æ¢
window.scrollPortfolio = (direction) => {
  currentIndex = (currentIndex + direction + items.length) % items.length;
  updateCarousel();
};

// ğŸ“ åˆå§‹åŒ–ï¼šç»‘å®šç‚¹å‡»äº‹ä»¶ä¸è®¾ç½®åˆå§‹çŠ¶æ€
items.forEach((item, idx) => {
  item.addEventListener('click', () => {
    // è·³è½¬åˆ°å¯¹åº”è¯¦æƒ…é¡µé¢ï¼Œè‡ªè¡Œè°ƒæ•´ URL è§„åˆ™
    window.location.href = `detail.html?id=${idx + 1}`;
  });
});
updateCarousel(); // é¦–æ¬¡åŠ è½½æ—¶è®¾ç½®çŠ¶æ€